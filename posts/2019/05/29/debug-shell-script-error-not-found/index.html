<!DOCTYPE html>

<html lang="en" data-theme="zero">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Debug shell script error: not found - Blog - CINAQ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/favicon-32x32.png">

    
        
            <link rel="preconnect" href="https://fonts.gstatic.com">
            <link href="https://fonts.googleapis.com/css2?family=Lato&amp;family=Source&#43;Sans&#43;Pro:wght@400;700&amp;display=swap" rel="stylesheet">
        
    

    
        
        
        <link rel="stylesheet" href="/theme.min.161506ed32926fa7ca1189b9a950311c0ab6251d75ce73ced64633d325529597.css">
        <link rel="stylesheet" href="/style.min.2fad554942a0618dbdc82e108c8707f02e34ba005607f3b364defcf7e22c9a1b.css">
    

    
        <script>
          localStorage.getItem('darkMode') === 'true' && document.documentElement.setAttribute('data-mode', 'dark');
        </script>
    

    <link rel="preload" href="/fonts/fontawesome5/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>

    
    
  <meta name="description" content="Shell scripts are easy to write and very effective in solving practical problems. However sometimes its error messages are very cryptic." />
  <meta property="og:title" content="Debug shell script error: not found" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/posts/2019/05/29/debug-shell-script-error-not-found/" />
  <meta property="og:image" content="/media/dan-wilding-ewFbCoV3kA4-unsplash.jpg" />
  <meta property="og:description" content="Shell scripts are easy to write and very effective in solving practical problems. However sometimes its error messages are very cryptic."  />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@cinaq_com" />
  <meta name="twitter:creator" content="@xiwenc" />

    <script>
        window.Papercups = {
          config: {
            accountId: "67b88fb6-49cd-4a83-8f9d-4defa35cb940",
            title: "Live Support",
            subtitle: "Ask us anything in the chat window below ðŸ˜Š",
            primaryColor: "#00d084",
            greeting: "Hello! How can I help you?",
            awayMessage: "Sorry, we are currently not available. Please leave a message with your contact details and we will get back to you.",
            newMessagePlaceholder: "Start typing...",
            showAgentAvailability: false,
            agentAvailableText: "We're online right now!",
            agentUnavailableText: "We're away at the moment.",
            requireEmailUpfront: false,
            iconVariant: "outlined",
            baseUrl: "https://app.papercups.io",
            
            
            
            
            
            
            
            
            
          },
        };
        </script>
        <script
        type="text/javascript"
        async
        defer
        src="https://app.papercups.io/widget.js"
        ></script>
</head>





    


    


<body class='page page-posts-single '>

<div id="header" class='header '>
    <div class="container">
  

<div class="logos">
  <div class="logo">
    
      <a href="/">
        <img class="logo-image" height="32" alt=" Logo" src="/images/logo.svg" />
        
      </a>
    
  </div>
  <div class="logo-invert">
    
      <a href="/">
        <img class="logo-image" height="32" alt=" Logo" src="/images/logo-inverted.svg" />
        
      </a>
    
  </div>
  <div class="logo-mobile">
    
      <a href="/">
        <img class="logo-image" height="32" alt=" Logo" src="/images/logo.svg" />
        
      </a>
    
  </div>
  <div class="logo-invert-mobile">
    
      <a href="/">
        <img class="logo-image" height="32" alt=" Logo" src="/images/logo-inverted.svg" />
        
      </a>
    
  </div>
</div>

  <div class="menus">
    <div class="main-menu">
    <ul>
        
        
    
        
            <li class="menu-item-appsec">
            <a href="/appsec">
                
                <span>AppSec</span>
            </a>
        
        
    
        
            <li class="menu-item-services">
            <a href="/services">
                
                <span>Services</span>
            </a>

            <div class="dropdown">
                <span class="triangle"></span>
                <ul class="sub-menu">
                    
                    <li class="">
                        <a href="/services/cloud-consultancy">Cloud Consultancy</a>
                    
                    <li class="">
                        <a href="/services/mendix-security-assessment">Mendix Security Assessment</a>
                    
                    <li class="">
                        <a href="/services/mendix-deployment">Mendix Deployment</a>
                    
                </ul>
            </div>
        
        
    
        
            <li class="menu-item-blog">
            <a href="/posts/">
                
                <span>Blog</span>
            </a>
        
        
    </ul>
</div>

    
      <div class="d-none d-md-block">
        <div id="dark-mode-container" class="dark-mode ">
    <div class="dark-mode-switch">
        <i class="fas fa-moon"></i>
        <i class="fas fa-sun"></i>
        <div class="ball"></div>
    </div>
</div>
      </div>
    
    
      <div id="main-menu-mobile" class="main-menu-mobile">
  <div class="main-menu-mobile-inner">

    <h2>Menu</h2>
    <ul>
      
      

      
      <li class="menu-item menu-item-appsec">
      <a href="/appsec">
        
        <span>AppSec</span>
      </a>
      
      

      
      <li class="menu-item menu-item-services">
      <a href="/services">
        
        <span>Services</span>
      </a>
      
      <li class="menu-sub-item ">
      <a href="/services/cloud-consultancy">Cloud Consultancy</a>
      
      <li class="menu-sub-item ">
      <a href="/services/mendix-security-assessment">Mendix Security Assessment</a>
      
      <li class="menu-sub-item ">
      <a href="/services/mendix-deployment">Mendix Deployment</a>
      
      
      

      
      <li class="menu-item menu-item-blog">
      <a href="/posts/">
        
        <span>Blog</span>
      </a>
      
      
    </ul>

    <h2>Options</h2>
    <div class="menu-extra">
      
      <ul>
        <li>Darkmode <div id="dark-mode-container" class="dark-mode dark-mode-invert">
    <div class="dark-mode-switch">
        <i class="fas fa-moon"></i>
        <i class="fas fa-sun"></i>
        <div class="ball"></div>
    </div>
</div></li>
      </ul>
      
    </div>

  </div>
</div>

      <div id="toggle-main-menu-mobile" class="menu-trigger js-nav-toggle">
<button class="hamburger">Menu</button>
</div>
    
  </div>
</div>

</div>

<div id="wrapper" class="wrapper">
    
<div class="strip strip-base">
  <div class="container">

    
    <div class="row">
      <div class="col-12 mb-3">
        <div class="title-image">
          <img src="/media/dan-wilding-ewFbCoV3kA4-unsplash.jpg" />
        </div>
      </div>
    </div>
    

    <div class="row justify-content-center">
      <div class="col-12 col-lg-8 mb-4">
        <div class="title">
          <h1>Debug shell script error: not found</h1>
        </div>
      </div>
    </div>
    
    <div class="row justify-content-center">
      <div class="col-12 col-lg-8">
        <div class="post post-single">
            <div class="post-author">
              <div class="post-author-avatar">
                <img src="/images/xiwen.png" alt=""/>
              </div>
              <div class="post-author-info">
                <a class="post-author-name" href="/authors/xiwen-cheng/">Xiwen Cheng</a>
                
                
                <span class="post-author-date">Apr 13, 2021</span>
                
              </div>
            </div>
            
          
          <div class="content"><p>Automation engineers often have boring tasks. Their job is to automate repetitive tasks. In the early days of Unix and Linux most automation is done with shell scripts. Nowadays we use higher level configuration management systems like <a href="https://www.ansible.com/">Ansible</a>, <a href="https://puppet.com/">Puppet</a>, <a href="https://www.saltstack.com/">Salt</a>, etc replacing most of the erroneous scripts with poor error handling, lots of boiler code and more importantly high maintenance cost.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ./main.sh
./main.sh: 3: exec: ./external.sh: not found
$ ls -l
-rwxr-xr-x <span class="m">1</span> xiwen xiwen <span class="m">33</span> May <span class="m">29</span> 01:25 external.sh
-rwxr-xr-x <span class="m">1</span> xiwen xiwen <span class="m">38</span> May <span class="m">29</span> 02:01 main.sh
</code></pre></div>
<link rel="stylesheet" href="/css/hugo-easy-gallery.css" />
<div class="box" >
  <figure  itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
    <div class="img">
      <img itemprop="thumbnail" src="https://media.giphy.com/media/xT0xeuOy2Fcl9vDGiA/giphy.gif" alt="What is this?"/>
    </div>
    <a href="https://media.giphy.com/media/xT0xeuOy2Fcl9vDGiA/giphy.gif" itemprop="contentUrl"></a>
      <figcaption>
          <p>What is this?</p>
      </figcaption>
  </figure>
</div>

<p>Even though we have these fantastic tools we often fall back to shell. Itâ€™s still the favorite method of quickly drafting a script improving our efficiency. Also shell scripts are reasonably portable without dependency on some tools that might be absent; every Linux system is shipped with a shell. Since it is so easy to create and use them, shell scripts are still widely used.</p>
<h2 id="poor-feedback-from-shell-script">Poor feedback from shell script</h2>
<p>As pointed out earlier error handling is often minimal in shell scripts. This is a natural consequence because scripts focusses being short. Therefore happy case is the only use case supported. Error handling relies on the child tools/processes to give useful feedback on error.</p>
<p>A simplified case is as follow.</p>
<p>We have our entry-point script called <code>main.sh</code> containing:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/usr/bin/env sh
</span><span class="cp"></span>
<span class="nb">exec</span> ./external.sh
</code></pre></div><p>And our <code>external.sh</code> contains:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/usr/bin/env sh
</span><span class="cp"></span>
<span class="nb">echo</span> Hello <span class="nv">$0</span>
</code></pre></div><p>Create these files on your system and make them executable so that you can run them:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">chmod +x main.sh
chmod +x external.sh
</code></pre></div><p>Running the script <code>./main.sh</code> fails with:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">./main.sh: 3: exec: ./external.sh: not found
</code></pre></div><p>First reaction is: what does this mean?</p>
<p><code>exec</code> function is complaining about <code>./external.sh</code> cannot be found. At least that was my initial interpretation. However that does not make any sense because <code>./external.sh</code> script does exist. That is very confusing.</p>
<h2 id="debugging-with-strace">Debugging with <code>strace</code></h2>
<p><a href="https://linux.die.net/man/1/strace">Strace</a> is diagnostic utility for Linux. Let&rsquo;s use it to debug our original program. The result of <code>strace ./main.sh</code> looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">... snip ...
read<span class="o">(</span>10, <span class="s2">&#34;#!/usr/bin/env sh\n\nexec ./extern&#34;</span>..., 8192<span class="o">)</span> <span class="o">=</span> <span class="m">38</span>
execve<span class="o">(</span><span class="s2">&#34;./external.sh&#34;</span>, <span class="o">[</span><span class="s2">&#34;./external.sh&#34;</span><span class="o">]</span>, 0x5632d3cf8038 /* <span class="m">68</span> vars */<span class="o">)</span>
  <span class="o">=</span> -1 ENOENT <span class="o">(</span>No such file or directory<span class="o">)</span>
write<span class="o">(</span>2, <span class="s2">&#34;./main.sh: 3: exec: &#34;</span>, 20./main.sh: 3: exec: <span class="o">)</span>    <span class="o">=</span> <span class="m">20</span>
write<span class="o">(</span>2, <span class="s2">&#34;./external.sh: not found&#34;</span>, 24./external.sh: not found<span class="o">)</span> <span class="o">=</span> <span class="m">24</span>
write<span class="o">(</span>2, <span class="s2">&#34;\n&#34;</span>, <span class="m">1</span>
<span class="o">)</span>                       <span class="o">=</span> <span class="m">1</span>
exit_group<span class="o">(</span>127<span class="o">)</span>                         <span class="o">=</span> ?
+++ exited with <span class="m">127</span> +++
</code></pre></div><p>It doesn&rsquo;t give us any new information. Still a confusing error message.</p>
<h2 id="manual-debugging">Manual debugging</h2>
<p>How about we run <code>./external.sh</code> ourselves?</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">bash: ./external.sh: /usr/bin/envsh: bad interpreter:
  No such file or directory
</code></pre></div><p>Aha! There was a typo in the interpreter path on the <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> line. That resulted in a rather cryptic error message. Fixing the shebang typo to <code>#!/usr/bin/env sh</code> in <code>./external.sh</code> our main script works:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">Hello ./external.sh
</code></pre></div><h2 id="use-bash-as-alternative">Use <code>bash</code> as alternative</h2>
<p>Let&rsquo;s change our shell interpreter from <a href="https://en.wikipedia.org/wiki/Bourne_shell">Bourne Shell</a> to <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> in <code>main.sh</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/usr/bin/env bash
</span><span class="cp"></span>
<span class="nb">exec</span> ./external.sh
</code></pre></div><p>Now the error message is:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">./main.sh: /tmp/external.sh: /usr/bin/envsh: bad interpreter:
  No such file or directory
./main.sh: line 3: /tmp/external.sh: Success
</code></pre></div><p>The failure message is much clearer with <code>bash</code>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Shell scripts are still very popular because they are easy to write and use; unless the script fails. Then it becomes a hell of a job to debug if the script did not have good error handling in place to point you to the root cause of the failure. Itâ€™s very hard to debug because not all child calls give useful feedback to the user. Most scripts bail out on error and therefore rely on subscripts and programs to give good feedback.</p>
<p>Bottom line is if you don&rsquo;t need to support the old <code>sh</code> Bourne shell, prefer to use the more modern, user friendly and powerful <code>bash</code>. Happy scripting!</p>
</div>
        </div>
      </div>
    </div>

  </div>
</div>

</div>

<div class="footer">
  <div class="strip strip-base strip-border-top">
    <div class="container">
      <div class="row">

        <div class="col-12 col-md-6">
          
            <h3>Social Media</h3>
          
          
            
<div id="social" class="social">
  
    <a href="https://twitter.com/cinaq_com" target="blank" title="Twitter">
      <i class="fab fa-twitter" ></i>
    </a>
  
    <a href="https://github.com/cinaq" target="blank" title="Github">
      <i class="fab fa-github" ></i>
    </a>
  
    <a href="https://cinaq.slack.com" target="blank" title="Slack">
      <i class="fab fa-slack" ></i>
    </a>
  
    <a href="https://www.linkedin.com/company/cinaq" target="blank" title="Linkedin">
      <i class="fab fa-linkedin" ></i>
    </a>
  
    <a href="https://www.cinaq.com/index.xml" target="blank" title="RSS">
      <i class="fab fa-readme" ></i>
    </a>
  
  </div>

          
          
            <p>Engineered in Rotterdam, The Netherlands.</p>
          
          
            <a class="copyright" href="https://cinaq.com">2021 - cinaq.com</a>
          
        </div>

        
        <div class="col-12 col-md-3">
          
            <h3>Company</h3>
          
          <div class="footer-menu">
  <ul>
    
    
    <li class="menu-item menu-item-home">
      <a href="/">
        Home
      </a>
    </li>
    
    <li class="menu-item menu-item-blog">
      <a href="/posts/">
        Blog
      </a>
    </li>
    
    <li class="menu-item menu-item-about-us">
      <a href="/about-us">
        About Us
      </a>
    </li>
    
    <li class="menu-item menu-item-contact-us">
      <a href="/contact-us">
        Contact Us
      </a>
    </li>
    
    <li class="menu-item menu-item-privacy-policy">
      <a href="/privacy/">
        Privacy Policy
      </a>
    </li>
    
  </ul>
</div>
        </div>
        

        
        <div class="col-12 col-md-3">
          <h3>Projects/Products</h3>
          <div class="footer-menu">
  <ul>
    
    
    <li class="menu-item menu-item-appsec">
      <a href="/appsec">
        AppSec
      </a>
    </li>
    
    <li class="menu-item menu-item-hackme">
      <a href="https://github.com/cinaq/hackme">
        HackMe
      </a>
    </li>
    
    <li class="menu-item menu-item-fastpush">
      <a href="https://github.com/xiwenc/fastpush">
        Fastpush
      </a>
    </li>
    
    <li class="menu-item menu-item-photography">
      <a href="/photography">
        Photography
      </a>
    </li>
    
  </ul>
</div>
        </div>
        

        

      </div>
    </div>
  </div>
</div>







    
    
    
        <script type="text/javascript" src="/js/darkModeBundle.min.66e9cf16bf22cc437e1dd000c03b528cfaa64415e9234c81cd6870889cc670f7.js"></script>
    



    <script type="text/javascript" src="/js/bundle.min.6dbf9c93f70f56e3ec86d775dad3b677286f26faec69e10a3d7a810b32aff69b.js"></script>





  
  
    
      
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74177616-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-74177616-1');
      </script>
    
  



</body>
</html>
